% Also note that the "draftcls" or "draftclsnofoot", not "draft", option
% should be used if it is desired that the figures are to be displayed in
% draft mode.
\documentclass[10pt,onecolumn,final]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}

%\usepackage{alltt, parskip, fancyheadings, boxedminipage}
\usepackage{alltt, boxedminipage}

% Redefine \tilde so it inserts a properly sized tilde, rather than an accent over the following letter.
\renewcommand{\tilde}{\raise.17ex\hbox{$\scriptstyle\mathtt{\sim}$}}

% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)

% *** CITATION PACKAGES ***
%
\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 4.0 (2003-05-27) and later if using hyperref.sty. cite.sty does
% not currently provide for hyperlinked citations.
% The latest version can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/cite/
% The documentation is contained in the cite.sty file itself.

% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
%
% paper title
% can use linebreaks \\ within to get better formatting as desired
\title{VLBA Pipeline Manual}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Jared Crossley, NRAO, jcrossle@nrao.edu}

% The paper headers
\markboth{VLBA Pipeline Manual, Typeset: \today}%
%{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}
{Crossley: VLBA Pipeline Manual}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2007 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle


\begin{abstract}
%\boldmath
The VLBA Pipeline is an automated data reduction software system for VLBA visibility data.  The pipeline is described here.
\end{abstract}
% IEEEtran.cls defaults to using nonbold math in the Abstract.
% This preserves the distinction between vectors and scalars. However,
% if the journal you are submitting to favors bold math in the abstract,
% then you can use LaTeX's standard command \boldmath at the very start
% of the abstract to achieve this. Many IEEE journals frown on math
% in the abstract anyway.

% Note that keywords are not normally used for peerreview papers.
%\begin{IEEEkeywords}
%IEEEtran, journal, \LaTeX, paper, template.
%\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle



\section{Introduction}
% The very first letter is a 2 line initial drop letter followed
% by the rest of the first word in caps.
% 
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
% 
% form to use if you need the single drop letter followed by
% normal text (unknown if ever used by IEEE):
% \IEEEPARstart{A}{}demo file is ....
% 
% Some journals put the first two words in caps:
% \IEEEPARstart{T}{his demo} file is ....
% 
% Here we have the typical use of a "T" for an initial drop letter
% and "HIS" in caps to complete the first word.
%\IEEEPARstart{T}{his} demo file is intended to serve as a ``starter file''
%for IEEE journal papers produced under \LaTeX\ using
%IEEEtran.cls version 1.7 and later.

The Very Long Baseline Array (VLBA) Pipeline is an automated data reduction system for VLBA data.  The primary goal of the pipeline is to generate end-user data products, such as images and spectra, from raw VLBA visibility data.  The pipeline also generates diagnostic information to aid end users in assessing quality of the primary data products.

% You must have at least 2 lines in the paragraph with the drop letter
% (should never be an issue)
%I wish you the best of success.



%\hfill mds

%\hfill January 11, 2007

\section{Pipeline Installation and Execution}

The pipeline software is part of the larger Obit package\cite{Cotton:Obit}.  To use the pipeline first install Obit\footnote{\tt http://www.cv.nrao.edu/{\tilde}bcotton/Obit.html}.  The pipeline scripts are described in section \ref{files}, below.  Assuming the scripts are copied to a common working directory and the input parameters ({\tt params.py} and {\tt AIPSSetup.py}) properly setup, the pipeline can be started with the command
\begin{quote}\tt python VLBAContPipe.py AIPSSetup.py parms.py\end{quote}
from the shell command line.

\section{Data Reduction Process}

The pipeline processes are described here in run-time order.

\begin{enumerate}
\item Load data.  Data can be loaded from a single FITS IDI file on disk, or from the AIPS catalog.  (doLoadIDI)
\item Delete any previous calibration and editing tables (SN, CL, BP, FG) that were performed on this data set. (doClearTab)
\item Optionally copy flag table (FG) version 1 to flag table version 2.  (doCopyFG)
\item Flag any data already known to be bad.  This bad data must be specified using the editList parameter. (doEditList)
\item Flag beginning and end of each scan, if desired.  (doQuack)
% The following item is only done for spectral line data.
%\item Add frequency and velocity information.  (doFreqInfo)  This information must be specified in the pipeline parameters restfreq and srcVel.
\item Apply a quantization correction with the smoothing time and flagging threshold specified as QuantSmo and QuantFlag, respectively.  (doQuantCor)
\item Make parallactic angle correction, if desired.  (doPACor)
\item Make an opacity and gain correction.  (doOpacCor)
\item Find the best calibration source, time range, and reference antenna. (doFindCal)
\item Perform manual phase calibration.  (doManPCal)
\item Perform bandpass calibration.  (doBPCal)
\item Image calibration sources.  (doImgCal)
\item Create models using images of the calibrator sources.
\item Determine delay corrections using calibrators.  (doDelayCal)
\item Determine amplitude calibration from calibrators.  (doAmpCal)
\item Calibrate and average data.  Use CalAvgTime to specify number of seconds over which averaging should be done.  (doCalAvg)
\item Optionally write uv data to a FITS file.  (doSaveUV)
\item Optionally write tables (without data) to a FITS file.  (doSaveTab)
\item Optionally delete data files.  (doCleanup)
\item Ouput FITS files for each of the continuum calibrators.  (doSavImg)
\end{enumerate}

\section{Files} \label{files}

The files used and generated by the pipeline are described here.  All pipeline scripts and input files are read from the current directory.  Likewise, all pipeline outputs are written to the current directory.

\subsection{Python Scripts}

The following files can be found within the Obit installation in directory {\tt ObitSystem/Obit/python}, unless otherwise noted.

\begin{description}
\item[\tt VLBAContPipe.py] \hfill \\ This is the top-level pipeline script and can be divided into three parts.  (i) The first part of the script imports required python modules.  (ii) The second part initializes the pipeline by defining variables used later in the script: the AIPS setup file (AIPSSetup.py) is executed, all input parameters are given default values, and the input parameters for the current data set are read from params.py.  (iii) Finally, the data is reduced by invoking functions defined in VLBACal.py.

\item[\tt AIPSSetup.py] \hfill \\ Located in ObitSystem/Obit/share/scripts, this file initializes python objects and environment variables used by Obit and AIPS.  For example, this file defines the AIPS user number, AIPS disk (data directory), and FITS disk (directory) used by the pipeline, and also sets the number of allowed threads used by the multi-threaded Obit objects.

\item[\tt \emph{parms.py}] \hfill \\ \emph{Eventually, this file will be automatically generated by a script and will hold unique parameter values for each data set.}  For now, Python objects defined with default values in {\tt VLBAContPipe.py} can be copied into this file by hand.  These parameters will then be reassigned with the current data set in mind.  Some of the important information stored in this file includes: the project name, session, and receiver band letter that will be displayed in pipeline output; the input datafile(s); calibrator names; many variables that control which pipeline functions are run and how they run.

\item[\tt VLBACal.py] \hfill \\ This file defines the VLBACal module, which contains functions for editing and calibrating VLBA data.  The module is documented in appendix \ref{VLBACal}.

\item[\tt VLBALinePipe.py] \hfill \\  An early test script for processing spectral line data.  This script could be integrated into the pipeline system in the future.
\end{description}

\subsection{Primary Data Products}

The following data products are written to the current working directory.

\begin{description}
\item[FITS Images] \hfill \\ Images are written to FITS files named {\tt{\em SrcName}.ImgSC.fits}, where {\em SrcName} is replaced by the source name.

\item[Calibrated Visibility Data (multisource)?] \hfill \\ 

\item[Calibrated Visibility Data (single source)?] \hfill \\ 

\item[Calibration Tables (w/o data)?] \hfill \\ 

\end{description}

\subsection{Diagnostic Products}

These data products are also written to the current working directory.

\begin{description}

\item[Plots] \hfill \\  Diagnostic plots are written to PostScript files with names {\tt {\em PCode}\_{\em SCode}\_{\em Band}{\em PlotType}.ps}.  {\em Pcode} is the project code; {\em Scode} is the session code; {\em Band} is the observing band letter; {\em PlotType} is a word describing the contents of the file, such as `AmpCal' or `Opacity'.  (Example: {\tt BL149\_AJ\_UOpacity.ps}) 
 
\item[Log] \hfill \\ All messages generated during processing are written to a log file named {\tt {\em PCode}\_{\em SCode}\_{\em Band}.log}, where {\em PCode}, {\em SCode}, {\em Band} are described above.  (Example: {\tt BL149\_AJ\_U.log})

\end{description}

%\section{Conclusion}
%In conclusion, the VLBA Pipeline is simply amazing.



% if have a single appendix:
\small
\appendices
\label{VLBACal} \include{VLBACal-module}

% or
%\appendix  % for no appendix heading
% do not use \section anymore after \appendix, only \section*
% is possibly needed

% use appendices with more than one appendix
% then use \section to start each appendix
% you must declare a \section before using any
% \subsection or using \label (\appendices by itself
% starts a section numbered zero.)
%


%\appendices
%\section{Proof of the First Zonklar Equation}
%Appendix one text goes here.

%% you can choose not to have a title for an appendix
%% if you want by leaving the argument blank
%\section{}
%Appendix two text goes here.

%
%% use section* for acknowledgement
%\section*{Acknowledgment}

%
%The authors would like to thank...


% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
\begin{thebibliography}{1}

\bibitem{Cotton:Obit}
W.~D. Cotton, ``Obit: A Development Environment for Astronomical Algorithms,'' \emph{The Publications of the Astronomical Society of the Pacific}, vol. 120, no. 866, Apr., pp. 439-448, 2008.

%\bibitem{IEEEhowto:kopka}
%H.~Kopka and P.~W. Daly, \emph{A Guide to \LaTeX}, 3rd~ed.\hskip 1em plus
%  0.5em minus 0.4em\relax Harlow, England: Addison-Wesley, 1999.

\end{thebibliography}

% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{biography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:

%\begin{IEEEbiography}{Michael Shell}
%Biography text here.
%\end{IEEEbiography}

% if you will not have a photo at all:
%\begin{IEEEbiographynophoto}{John Doe}
%Biography text here.
%\end{IEEEbiographynophoto}

% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

%\begin{IEEEbiographynophoto}{Jane Doe}
%Biography text here.
%\end{IEEEbiographynophoto}

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks
\end{document}


